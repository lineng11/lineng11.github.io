<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="Django-REST-Framework"/>




  <meta name="keywords" content="Python工具," />




  <link rel="alternate" href="/atom.xml" title="Neng Lee">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.1.0" />



<link rel="canonical" href="http://nenglee.com/2018/08/23/Python/Django-REST-Framework/"/>


<meta name="description" content="Django REST框架是构建Web API的强大而灵活的模块。
django-rest-framework – github
django-rest-framework – Web API">
<meta property="og:type" content="article">
<meta property="og:title" content="Django-REST-Framework">
<meta property="og:url" content="http://nenglee.com/2018/08/23/Python/Django-REST-Framework/index.html">
<meta property="og:site_name" content="Neng Lee">
<meta property="og:description" content="Django REST框架是构建Web API的强大而灵活的模块。
django-rest-framework – github
django-rest-framework – Web API">
<meta property="og:updated_time" content="2018-09-19T15:12:35.793Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Django-REST-Framework">
<meta name="twitter:description" content="Django REST框架是构建Web API的强大而灵活的模块。
django-rest-framework – github
django-rest-framework – Web API">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.1.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?68f20218dfa1d6e19d0130b4bf5575fd";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




    <title> Django-REST-Framework · Neng Lee </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Neng Lee</a>
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            归档
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/categories/随笔/">
            随笔
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            分类
          </a>
        </li>
      
        
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            关于
          </a>
        </li>
      
      
        <li class="menu-search">
          <form>
            <i class="iconfont icon-search" id="open-search"></i>
            <input type="text" class="search-input" id="search-input" />
            <i class="iconfont icon-close" id="close-search"></i>
          </form>
        </li>
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">Neng Lee</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      
      <a class="mobile-menu-item" href="/">
        首页
      </a>
    
      
      <a class="mobile-menu-item" href="/archives/">
        归档
      </a>
    
      
      <a class="mobile-menu-item" href="/categories/随笔/">
        随笔
      </a>
    
      
      <a class="mobile-menu-item" href="/categories">
        分类
      </a>
    
      
      <a class="mobile-menu-item" href="/about">
        关于
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          Django-REST-Framework
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018年8月23日
        </span>
      </div>
    </header>

    
      <div class="post-toc" id="post-toc">
        <h2 class="post-toc-title">文章目录</h2>
        <div class="post-toc-content">
          <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#为什么用REST-Framework"><span class="toc-text">为什么用REST-Framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#安装"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Request-解析"><span class="toc-text">Request 解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#data"><span class="toc-text">.data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#query-params"><span class="toc-text">.query_params</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#parsers"><span class="toc-text">.parsers</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Responses-解析"><span class="toc-text">Responses 解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#创建-response"><span class="toc-text">创建 response</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#属性"><span class="toc-text">属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#drf跨域问题"><span class="toc-text">drf跨域问题</span></a></li></ol>
        </div>
      </div>
    

    <div class="post-content">
      
        <excerpt in="" index="" |="" 首页摘要="">

<p>Django REST框架是构建Web API的强大而灵活的模块。</p>
<p><a href="https://github.com/encode/django-rest-framework" target="_blank" rel="external">django-rest-framework – github</a></p>
<p><a href="http://www.django-rest-framework.org" target="_blank" rel="external">django-rest-framework – Web API</a></p>
<a id="more"></a>
<the rest="" of="" contents="" |="" 余下全文="">

<hr>
<h3 id="为什么用REST-Framework"><a href="#为什么用REST-Framework" class="headerlink" title="为什么用REST-Framework"></a>为什么用REST-Framework</h3><ol>
<li><p>开发API具有友好，方便，快捷。</p>
</li>
<li><p>认证策略，包括OAuth1a和OAuth2的可选包。</p>
</li>
<li><p>支持ORM和非ORM数据源的序列化。</p>
</li>
<li><p>可定制的所有方式。</p>
</li>
<li><p>广泛的文件和巨大的社会支持。</p>
</li>
</ol>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>  <code>pip install djangorestframework</code></p>
<ul>
<li><p>配置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">INSTALLED_APPS = (</div><div class="line">  ...</div><div class="line">  <span class="string">'rest_framework'</span>,</div><div class="line">  )</div></pre></td></tr></table></figure>
</li>
<li><p><code>coreapi (1.32.0+)</code> - Schema generation support.</p>
</li>
<li><p><code>Markdown (2.1.0+)</code> - Markdown support for the browsable API.</p>
</li>
<li><p><code>django-filter (1.0.1+)</code> - Filtering support.</p>
</li>
<li><p><code>django-crispy-forms</code> - Improved HTML display for filtering.</p>
</li>
<li><p><code>django-guardian (1.1.1+)</code> - Object level permissions support.</p>
</li>
</ul>
<h3 id="Request-解析"><a href="#Request-解析" class="headerlink" title="Request 解析"></a>Request 解析</h3><p>REST framwork 的 Request 对象提供了灵活的请求解析，允许你使用 JSON data 或 其他 media types 像通常处理表单数据一样处理请求。</p>
<h4 id="data"><a href="#data" class="headerlink" title=".data"></a>.data</h4><p>  <code>request.data</code> 返回请求主题的解析内容。这跟标准的 <code>request.POST</code> 和 <code>request.FILES</code> 类似</p>
<p>  并且还具有以下特点：</p>
<ul>
<li><p>包括所有解析的内容，文件（file） 和 非文件（non-file inputs）。</p>
</li>
<li><p>支持解析 POST 以外的 HTTP method ， 比如 PUT， PATCH。</p>
</li>
<li><p>更加灵活，不仅仅支持表单数据，传入同样的 JSON 数据一样可以正确解析，并且不用做额外的处理（意思是前端不管提交的是表单数据，还是 JSON 数据，.data 都能够正确解析）。</p>
</li>
</ul>
<h4 id="query-params"><a href="#query-params" class="headerlink" title=".query_params"></a>.query_params</h4><p>  <code>request.query_params</code> 等同于 <code>request.GET</code>，不过其名字更加容易理解。</p>
<p>  为了代码更加清晰可读，推荐使用 <code>request.query_params</code> ，而不是 <code>Django</code> 中的 <code>request.GET</code></p>
<p>  这样那够让你的代码更加明显的体现出 —– 任何 HTTP <code>method</code> 类型都可能包含查询参数（query parameters），而不仅仅只是 ‘GET’ 请求。</p>
<h4 id="parsers"><a href="#parsers" class="headerlink" title=".parsers"></a>.parsers</h4><p>  <code>APIView</code> 类或者 <code>@api_view</code> 装饰器将根据视图上设置的 <code>parser_classes</code> 或 <code>settings</code> 文件中的 <code>DEFAULT_PARSER_CLASSES</code> 设置来确保此属性（.parsers）自动设置为 Parser 实例列表。</p>
<p>  如果你非要看看它里面是什么，可以打印出来看看，大概长这样：<br>  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">class</span> '<span class="attr">list</span>'&gt;</span>:</div><div class="line">  [<span class="tag">&lt;<span class="name">rest_framework.parsers.JSONParser</span> <span class="attr">object</span> <span class="attr">at</span> <span class="attr">0x000000BD97DC6710</span>&gt;</span>,</div><div class="line">  <span class="tag">&lt;<span class="name">rest_framework.parsers.FormParser</span> <span class="attr">object</span> <span class="attr">at</span> <span class="attr">0x000000BD97DC66A0</span>&gt;</span>,</div><div class="line">  <span class="tag">&lt;<span class="name">rest_framework.parsers.MultiPartParser</span> <span class="attr">object</span> <span class="attr">at</span> <span class="attr">0x000000BD97DC67B8</span>&gt;</span>]</div></pre></td></tr></table></figure></p>
<p>  包含三个解析器 JSONParser，FormParser，MultiPartParser。</p>
<blockquote>
<p>注意： 如果客户端发送格式错误的内容，则访问 request.data 可能会引发 ParseError 。默认情况下， REST framework 的 APIView 类或者  /@api_view 装饰器将捕获错误并返回 400 Bad Request 响应。 如果客户端发送的请求内容无法解析（不同于格式错误），则会引发 UnsupportedMediaType 异常，默认情况下会被捕获并返回 415 Unsupported Media Type 响应。</p>
</blockquote>
<h3 id="Responses-解析"><a href="#Responses-解析" class="headerlink" title="Responses 解析"></a>Responses 解析</h3><blockquote>
<p>与基本的 HttpResponse 对象不同，TemplateResponse 对象保留了视图提供的用于计算响应的上下文的详细信息。直到需要时才会计算最终的响应输出，也就是在后面的响应过程中进行计算。 — Django 文档</p>
</blockquote>
<p><code>REST framework</code> 通过提供一个 Response 类来支持 HTTP 内容协商，该类允许你根据客户端请求返回不同的表现形式（如： JSON ，HTML 等）。</p>
<p>Response 类的子类是 Django 的 <code>SimpleTemplateResponse</code>。Response 对象使用数据进行初始化，数据应由 Python 对象（native Python primitives）组成。然后 REST framework 使用标准的 HTTP 内容协商来确定它应该如何渲染最终响应的内容。</p>
<p>当然，您也可以不使用 Response 类，直接返回常规 <code>HttpResponse</code> 或 <code>StreamingHttpResponse</code> 对象。 使用 Response 类只是提供了一个更好的交互方式，它可以返回多种格式。</p>
<p>除非由于某种原因需要大幅度定制 REST framework ，否则应该始终对返回 <code>Response</code> 对象的视图使用 APIView 类或 @api_view 装饰器。这样做可以确保视图执行内容协商，并在视图返回之前为响应选择适当的渲染器。</p>
<h4 id="创建-response"><a href="#创建-response" class="headerlink" title="创建 response"></a>创建 response</h4><p>由于 Response 类使用的渲染器不能处理复杂的数据类型（比如 Django 的模型实例），所以需要在创建 Response 对象之前将数据序列化为基本的数据类型。</p>
<p>你可以使用 <code>REST framework 的 Serializer</code> 类来执行序列化的操作，也可以用自己的方式来序列化。</p>
<p>构造方法: <code>Response(data, status=None, template_name=None, headers=None, content_type=None)</code></p>
<p>参数：</p>
<ul>
<li><p><code>data：</code> 响应的序列化数据。</p>
</li>
<li><p><code>status：</code> 响应的状态代码。默认为200。</p>
</li>
<li><p><code>template_name：</code> 选择 HTMLRenderer 时使用的模板名称。</p>
</li>
<li><p><code>headers：</code> 设置 HTTP header，字典类型。</p>
</li>
<li><p><code>content_type：</code> 响应的内容类型，通常渲染器会根据内容协商的结果自动设置，但有些时候需要手动指定。</p>
</li>
</ul>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><ul>
<li><p><code>.data</code>   还没有渲染，但已经序列化的响应数据。</p>
</li>
<li><p><code>.status_code</code>    状态码</p>
</li>
<li><p><code>.content</code>    将会返回的响应内容，必须先调用 <code>.render()</code> 方法，才能访问 <code>.content</code> 。</p>
</li>
<li><p><code>.template_name</code>    只有在 response 的渲染器是 <code>HTMLRenderer</code> 或其他自定义模板渲染器时才需要提供。</p>
</li>
<li><p><code>.accepted_renderer</code>   用于将会返回的响应内容的渲染器实例。从视图返回响应之前由 APIView 或 api_view 自动设置。</p>
</li>
<li><p><code>.accepted_media_type</code>  内容协商阶段选择的媒体类型。</p>
</li>
<li><p><code>.renderer_context</code>    将传递给渲染器的 .render() 方法的附加的上下文信息字典。</p>
</li>
<li><p><code>.render()</code>   与其他任何 TemplateResponse 一样，调用此方法将响应的序列化数据呈现为最终响应内容。响应内容将设置为在 <code>accepted_renderer</code> 实例上调用 <code>.render(data，accepted_media_type，renderer_context)</code> 方法的结果</p>
</li>
</ul>
<h3 id="drf跨域问题"><a href="#drf跨域问题" class="headerlink" title="drf跨域问题"></a>drf跨域问题</h3><ul>
<li>安装模块 <code>pip install django-cors-headers</code></li>
</ul>
<p><code>django-cors-headers</code> 使用说明：<a href="https://github.com/ottoyiu/django-cors-headers" target="_blank" rel="external">https://github.com/ottoyiu/django-cors-headers</a></p>
<ul>
<li><p>添加App</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> INSTALLED_APPS = (</div><div class="line">   ...</div><div class="line">   <span class="string">'coreschema'</span>,</div><div class="line"><span class="meta">... </span>)</div></pre></td></tr></table></figure>
</li>
<li><p>添加中间件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">MIDDLEWARE = [</div><div class="line">    <span class="string">'corsheaders.middleware.CorsMiddleware'</span>,  <span class="comment">#当前 CorsMiddleware 放在第一个</span></div><div class="line">    <span class="string">'django.middleware.security.SecurityMiddleware'</span>,</div><div class="line">    <span class="string">'django.contrib.sessions.middleware.SessionMiddleware'</span>,</div><div class="line">    <span class="string">'django.middleware.common.CommonMiddleware'</span>,</div><div class="line">    <span class="string">'django.middleware.csrf.CsrfViewMiddleware'</span>,</div><div class="line">    <span class="string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span>,</div><div class="line">    <span class="string">'django.contrib.messages.middleware.MessageMiddleware'</span>,</div><div class="line">    <span class="string">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span>,</div><div class="line">]</div></pre></td></tr></table></figure>
</li>
<li><p>settings设置</p>
<p><code>CORS_ORIGIN_ALLOW_ALL = True</code></p>
</li>
</ul>
</the></excerpt>
      
    </div>

    
      <footer class="post-footer">
        <div class="post-tags">
          
            <a href="/tags/Python工具/">Python工具</a>
          
        </div>

        
  <nav class="post-nav">
    
      <a class="prev" href="/2018/08/25/Python/Django-生鲜超市--商品列表页/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Django-生鲜超市--商品列表页</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2018/08/23/Python/Django-生鲜超市--xadmin/">
        <span class="next-text nav-default">Django-生鲜超市--xadmin后台管理</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    
  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2018/08/23/Python/Django-REST-Framework/"
           data-title="Django-REST-Framework" data-url="http://nenglee.com/2018/08/23/Python/Django-REST-Framework/">
      </div>
    
  </div>

        </div>  
      </main>

      <footer id="footer" class="footer">
  <div class="social-links">
    
      
        
          <a href="mailto:383356258@qq.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
        
          <a href="https://github.com/lineng11" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="http://weibo.com/u/1810748133" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
    
      
    
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Neng Lee</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"nenglee"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/even.js?v=2.1.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.1.0"></script>

  </body>
</html>